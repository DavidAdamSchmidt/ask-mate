{% extends "layout.html" %}

{% block title %}Home{% endblock %}

{% block content %}
    <table>
        <h1>Questions</h1>
        <tr>
            {% set new_direction = 'desc' if current_dir else 'asc' %}
            {% for key in question_list[0] %}
                <th>
                    <a href="/list?order_by={{ key }}&order_direction={{ new_direction }}">
                        {{ key.capitalize().replace('_', ' ') }}
                    </a>
                </th>
            {% endfor %}
        </tr>
        {% for question in question_list %}
            <tr>
            {% for key, value in question.items() %}
                {% if value == question['image'] %}
                    {% if value == "" %}
                        <td><p>No picture available</p></td>
                    {% else %}
                        <td><img src="{{ value }}" width="120" height="90"></td>
                    {% endif %}
                {% elif key == 'submission_time' %}
                    <td>
                        <a href="{{ url_for('route_question_display', question_id = question['id']) }}">
                            {{ value }}
                        </a>
                    </td>
                {% else %}
                    <td>{{ value }}</td>
                {% endif %}
            {% endfor %}
                <td class="no-border">
            {% for operation in ['up', 'down'] %}
                    {% set url = url_for(
                        'route_question_votes',
                        question_id = question['id'],
                        operation = operation
                    ) %}
                    <form action="{{ url }}" method="post">
                        <input type="submit" class="{{ operation }}" value="Vote {{ operation }}">
                    </form>

            {% endfor %}
                </td>
            </tr>
        {% endfor %}
    </table>
    <a href="{{ url_for('route_question_add') }}">Ask a question</a>
{% endblock %}