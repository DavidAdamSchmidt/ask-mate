{% extends 'layout.html' %}

{% block title %}
    Question details
{% endblock %}

{% block content %}
    {% if question %}
        <h1>Question {{ question['id'] }}</h1>
        <table>
            <tr>
            {% for header in question %}
                <th>{{ header.capitalize().replace('_', ' ') }}</th>
            {% endfor %}
            </tr>
            <tr>
            {% for value in question.values() %}
                {% if value == question['image'] %}
                    {% if value == "" %}
                        <td><p>No picture available</p></td>
                    {% else %}
                        <td><img src="{{ value }}" width="120" height="90"></td>
                    {% endif %}
                {% else %}
                    <td>{{ value }}</td>
                {% endif %}
            {% endfor %}
            </tr>
        </table>
        <h2>Answers:</h2>
        {% if answers %}
            <table>
                <tr>
                {% for header in answers[0] %}
                    <th>{{ header.capitalize().replace('_', ' ') }}</th>
                {% endfor %}
                </tr>
                {% for answer in answers %}
                    <tr>
                        {% for value in answer.values() %}
                            {% if value == answer['image'] %}
                                {% if value == "" %}
                                    <td><p>No picture available</p></td>
                                {% else %}
                                    <td><img src="{{ value }}" width="120" height="90"></td>
                                {% endif %}
                            {% else %}
                                <td>{{ value }}</td>
                            {% endif %}
                        {% endfor %}
                        <td class="no-border">
                        {% for operation in ['up', 'down'] %}
                                {% set url = url_for(
                                    'route_answer_votes',
                                    answer_id = answer['id'],
                                    operation = operation
                                ) %}
                            <form action="{{ url }}" method="post">
                                <input type="submit" class="{{ operation }}" value="Vote {{ operation }}">
                            </form>
                        {% endfor %}
                        {% set url = url_for(
                            'route_delete_answer',
                            answer_id=answer['id']
                            ) %}
                            <form action="{{ url }}" method="post">
                                <input type="submit" class="delete" value="Delete this answer">
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </table>
        {% else %}
            <p>There are no answers for this question</p>
        {% endif %}
        <a href="{{ url_for('route_add_answer', question_id=question['id']) }}">
            Add a new answer for this question
        </a><br>
        <a href="{{ url_for('route_delete_question', question_id=question['id']) }}">
            Delete this question
        </a>
    {% else %}
        <p>There is no question with id {{ question_id }}</p>
    {% endif %}
    <br>
    <a href="/">Back to homepage</a>
{% endblock %}